<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mehmet’in Arsası – Güncel Değer</title>
  <style>
    body{font-family:Arial,sans-serif; background:#111; color:#eee; text-align:center; padding:30px;}
    .val{font-size:48px; margin:20px 0;}
    .sub{font-size:16px; color:#aaa;}
    button{padding:10px 18px; margin:8px;}
  </style>
</head>
<body>
  <h1>Mehmet’in Arsası</h1>
  <div class="sub">468 gram altının güncel TL karşılığı:</div>
  <div class="val" id="price">Yükleniyor…</div>
  <div class="sub" id="extra"></div>
  <button onclick="load()">Yenile</button>
  <button onclick="share()">WhatsApp’ta Paylaş</button>

<script>
  const URL = "https://finans.truncgil.com/v4/today.json";
  const GRAM = 468;

  function fmt(n){
    return n.toLocaleString("tr-TR",{style:"currency",currency:"TRY",maximumFractionDigits:2});
  }

  async function load(){
    try{
      const r = await fetch(URL);
      const d = await r.json();

      const raw = d["gram-altin"] || d["GramAltin"] || d["GRAMALTIN"] || Object.values(d).find(x=>x?.Selling && x?.Buying);
      const price = Number(String(raw.Selling || raw.Buying).replace(/\./g,'').replace(',','.'));

      document.getElementById("price").innerText = fmt(price * GRAM);
      document.getElementById("extra").innerText = "1g: " + fmt(price);
    }catch(e){
      document.getElementById("price").innerText = "Veri alınamadı";
      document.getElementById("extra").innerText = "";
    }
  }
  function share(){
    const msg = "Mehmet’in arsası: 468g altın bugün ≈ " + document.getElementById("price").innerText;
    window.open("https://wa.me/?text=" + encodeURIComponent(msg), "_blank");
  }

  load();
</script>
</body>
</html>
